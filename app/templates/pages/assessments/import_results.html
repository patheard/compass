{% extends "base.html" %}

{% block content %}
<gcds-heading tag="h1">{{ assessment.product_name }}</gcds-heading>
<gcds-text>{{ _('Import completed. Review the results below.') }}</gcds-text>

<hr class="mt-600 mb-600">

<gcds-stepper current-step="2" total-steps="2" tag="h2">
  {{ _('Import results') }}
</gcds-stepper>

<div class="mt-400">
  <ul class="list-disc pl-500">
    <li><strong>{{ result.created_count }}</strong> {{ _('controls created') }}</li>
    {% if result.skipped_count == 0 and result.error_count == 0 %}
      <li>âœ… {{ _('All controls imported successfully!') }}</li>
    {% endif %}
    {% if result.skipped_count > 0 %}
      <li><strong>{{ result.skipped_count }}</strong> {{ _('controls skipped (already exist)') }}</li>
    {% endif %}
    {% if result.error_count > 0 %}
      <li><strong>{{ result.error_count }}</strong> {{ _('controls failed to import') }}</li>
    {% endif %}
  </ul>
</div>

{% if result.skipped_controls %}
<gcds-heading tag="h3">{{ _('Skipped controls') }}</gcds-heading>
<section class="table-container mb-300">
    <table>
        <thead>
            <tr>
                <th class="w-20">{{ _('Control ID') }}</th>
                <th>{{ _('Reason') }}</th>
            </tr>
        </thead>
        <tbody>
            {% for control in result.skipped_controls %}
                <tr>
                    <td class="nowrap">{{ control.nist_control_id }}</td>
                    <td>{{ control.reason }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</section>
{% endif %}

{% if result.errors %}
<gcds-heading tag="h3">{{ _('Errors') }}</gcds-heading>
<section class="table-container mb-300">
    <table>
        <thead>
            <tr>
                <th class="w-20">{{ _('Control ID') }}</th>
                <th>{{ _('Reason') }}</th>
            </tr>
        </thead>
        <tbody>
            {% for error in result.errors %}
                <tr>
                    <td class="nowrap">{{ error.nist_control_id }}</td>
                    <td>{{ error.error }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</section>
{% endif %}

<div class="mt-600">
  <gcds-button href="/assessments/{{ assessment.assessment_id }}" type="link" button-role="primary">
    {{ _('View assessment') }}
  </gcds-button>
</div>

{% endblock %}