{% extends "base.html" %}

{% block content %}
<gcds-heading tag="h1">{{ evidence.title }}</gcds-heading>
<gcds-text>
    {{ evidence.description }}
</gcds-text>

<ul class="list-disc mb-300" class="sm">
    <li>
        <strong>{{ _('Type:') }}</strong>
        {{ _(evidence.evidence_type) }}
    </li>
    <li>
        <strong>{{ _('Control:') }}</strong>
        <gcds-link href="/assessments/{{ assessment.assessment_id }}/controls/{{ control.control_id }}">{{ _(control.nist_control_id) }}</gcds-link>
    </li>
    <li>
        <strong>{{ _('Assessment:') }}</strong>
        <gcds-link href="/assessments/{{ assessment.assessment_id }}">{{ assessment.product_name }}</gcds-link>
    </li>
</ul>

{% if evidence.is_automated_collection %}
<gcds-heading tag="h2">{{ _("Evidence collection") }}</gcds-heading>

{% if scan_job_template %}
<gcds-details details-title="{{ _('Job') }}">
    <ul class="list-disc">
        <li>
            <strong>{{ _('Template Name:') }}</strong>
            <gcds-link href="/jobs/{{ scan_job_template.template_id }}">{{ scan_job_template.name }}</gcds-link>
        </li>
        <li>
            <strong>{{ _('Description:') }}</strong>
            {{ scan_job_template.description }}
        </li>
        <li>
            <strong>{{ _('Scan Type:') }}</strong>
            {{ scan_job_template.scan_type }}
        </li>
    </ul>
</gcds-details>
{% endif %}

{% if scan_executions %}
<gcds-details details-title="{{ _('Results') }}" class="table-container">
    <table>
        <thead>
            <tr>
                <th scope="col">{{ _('Status') }}</th>
                <th scope="col">{{ _('Started At') }}</th>
                <th scope="col">{{ _('Completed At') }}</th>
                <th scope="col">{{ _('Retry Count') }}</th>
            </tr>
        </thead>
        <tbody>
            {% for execution in scan_executions %}
            <tr>
                <td>{{ execution.status }}</td>
                <td>{{ execution.started_at or '-' }}</td>
                <td>{{ execution.completed_at or '-' }}</td>
                <td>{{ execution.retry_count }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</gcds-details>
{% else %}
<gcds-notice type="info" notice-title-tag="h3" notice-title="{{ _('No scan executions') }}">
    <gcds-text>{{ _('No scan executions have been created for this evidence yet.') }}</gcds-text>
</gcds-notice>
{% endif %}

{% endif %}

<gcds-button href="/assessments/{{ assessment.assessment_id }}/controls/{{ control.control_id }}/evidence/{{ evidence.evidence_id }}/edit" type="link" button-role="primary" class="mt-300">
    {{ _("Edit") }}
</gcds-button>
<gcds-button href="/assessments/{{ assessment.assessment_id }}/controls/{{ control.control_id }}/evidence/{{ evidence.evidence_id }}/delete" type="link" button-role="secondary" data-csrf-token="{{ csrf_token }}" class="delete-item">
    {{ _("Delete") }}
</gcds-button>



{% endblock %}